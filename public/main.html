<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lujo Network - CRM</title>

  <!-- ===== √çCONES ===== -->
  <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css">

  <!-- ===== CSS GLOBAIS ===== -->
  <link rel="stylesheet" href=".css/global.css">

  <!-- ===== SCRIPTS - ORDEM CR√çTICA ===== -->

  <!-- 1. FIREBASE CONFIG (primeiro, sem depend√™ncias) -->
  <script type="module" src="./js/core/firebase-config.js"></script>

  <!-- 2. MANAGERS GLOBAIS (dependem de utils, sem depend√™ncias de core) -->
  <script src="./js/managers/utils.js"></script>
  <script src="./js/managers/state-manager.js"></script>
  <script src="./js/managers/module-lifecycle.js"></script>
  <script src="./js/managers/tab-manager.js"></script>
  <script src="./js/managers/modal-manager.js"></script>
  <script src="./js/managers/list-manager.js"></script>
  <script src="./js/core/PriorityMaster.js"></script>
  <script src="./js/managers/demanda-state-machine.js"></script>
  <script src="./js/managers/notification-manager.js"></script>

  <!-- 3. CONFIGURA√á√ïES (dependem de managers) -->
  <script src="./js/config/permissions.js"></script>
  <script src="./js/config/routes.js"></script>

  <!-- 4. CORE - AUTENTICA√á√ÉO (depende de firebase-config) -->
  <script type="module" src="./js/core/auth.js"></script>

  <!-- 5. CORE - FILTRO DE PERMISS√ïES (depende de auth e routes) -->
  <script src="./js/core/permission-filter.js"></script>

  <!-- 6. CORE - MAIN ORQUESTRADOR (carrega m√≥dulos, √∫ltimo) -->
  <script type="module" src="./js/core/main.js"></script>
</head>

<body>
  <!-- ===== LAYOUT PRINCIPAL ===== -->
  <div class="app-layout">

    <!-- ===== SIDEBAR / NAVEGA√á√ÉO ===== -->
    <aside class="sidebar" id="sidebar" data-role="nav-container" role="navigation" aria-label="Navega√ß√£o principal">
      <a href="#" class="sidebar-link active" id="btnGoHome" title="Ir para o In√≠cio">
        <i class="fi fi-rr-home"></i>
        <span class="link-label">Home</span>
      </a>
      <div class="sidebar-divider"></div>
      <div id="dynamic-menu">
        <!-- Preenchido dinamicamente por permission-filter.js -->
        <div class="sidebar-loading">
          <p>‚è≥ Carregando menu...</p>
        </div>
      </div>
    </aside>

    <!-- ===== TRIGGER SIDEBAR (mobile) ===== -->
    <button class="sidebar-trigger" id="sidebar-trigger" aria-label="Abrir/fechar menu">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- ===== HEADER ===== -->
    <header class="header">
      <div class="header-left">
        <h1 class="app-title">Lujo Network</h1>
      </div>

      <div class="header-center">
        <nav class="breadcrumb" id="breadcrumb" role="navigation" aria-label="Breadcrumb">
          <!-- Preenchido dinamicamente -->
        </nav>
      </div>

      <div class="header-right">
        <!-- USER INFO (preenchido por permission-filter.js) -->
        <div class="user-info" data-role="user-info">
          <!-- Badges de user e role -->
        </div>

        <!-- A√á√ïES DO HEADER -->
        <div class="header-actions">
          <button class="btn btn-icon" id="btnSearch" title="Busca global (Ctrl+/)">
            <i class="fi fi-rr-search"></i>
          </button>
          <button class="btn btn-icon" id="btnNotifications" title="Notifica√ß√µes">
            <i class="fi fi-rr-bell"></i>
            <span class="notification-badge">0</span>
          </button>
          <button class="btn btn-icon" id="btnNewspaper" title="Configura√ß√µes">
            <i class="fi fi-rr-bell"></i>
          </button>
          <button class="btn btn-danger" id="btnLogout" data-action="logout" title="Sair (Ctrl+L)">
            <i class="fi fi-rr-sign-out"></i>
            Sair
          </button>
        </div>
      </div>
    </header>

    <!-- ===== MAIN CONTENT ===== -->
    <main id="app-container" class="app-container" role="main">
      <div id="dashboard-inicial" class="modulo-ativo">
        <div class="dashboard-header">
          <h1>Bem-vindo ao <span style="color: var(--color-primary);">Lujo Network CRM</span>! üëã</h1>
          <p>Selecione um m√≥dulo abaixo para come√ßar ou use a barra lateral para navegar</p>
        </div>

        <div class="dashboard-cards">
          <!-- Card: Atendimento -->
          <div class="dash-card" onclick="navegarParaModulo('atendimento')" data-module="atendimento">
            <i class="fi fi-rr-phone-call"></i>
            <h3>Atendimento</h3>
            <p>Gerencie tickets de WhatsApp, e-mails e demandas externas</p>
          </div>

          <!-- Card: Conte√∫do -->
          <div class="dash-card" onclick="navegarParaModulo('conteudo')" data-module="conteudo">
            <i class="fi fi-rr-music-alt"></i>
            <h3>Conte√∫do</h3>
            <p>Gerencie m√∫sicas, artistas e processos de lan√ßamento</p>
          </div>

          <!-- Card: Copyright -->
          <div class="dash-card" onclick="navegarParaModulo('copyright')" data-module="copyright">
            <i class="fi fi-rr-shield-check"></i>
            <h3>Copyright</h3>
            <p>Monitore direitos autorais e reivindica√ß√µes</p>
          </div>

          <!-- Card: Financeiro -->
          <div class="dash-card" onclick="navegarParaModulo('financeiro')" data-module="financeiro">
            <i class="fi fi-rr-dollar"></i>
            <h3>Financeiro</h3>
            <p>Controle receitas, despesas e pagamentos</p>
          </div>

          <!-- Card: Marketing -->
          <div class="dash-card" onclick="navegarParaModulo('marketing')" data-module="marketing">
            <i class="fi fi-rr-star"></i>
            <h3>Marketing</h3>
            <p>Campanhas, an√°lises e estrat√©gias de divulga√ß√£o</p>
          </div>

          <!-- Card: T√©cnico -->
          <div class="dash-card" onclick="navegarParaModulo('tecnico')" data-module="tecnico">
            <i class="fi fi-rr-users"></i>
            <h3>T√©cnico</h3>
            <p>Suporte t√©cnico e manuten√ß√£o de sistemas</p>
          </div>

          <!-- Card: Ger√™ncia -->
          <div class="dash-card" onclick="navegarParaModulo('gerencia')" data-module="gerencia">
            <i class="fi fi-rr-user"></i>
            <h3>Ger√™ncia</h3>
            <p>Vis√£o executiva e tomada de decis√µes</p>
          </div>

          <!-- Card: Relat√≥rios -->
          <div class="dash-card" onclick="navegarParaModulo('relatorios')" data-module="relatorios">
            <i class="fi fi-rr-chart-histogram"></i>
            <h3>Relat√≥rios</h3>
            <p>Dashboards, m√©tricas e an√°lises detalhadas</p>
          </div>

          <!-- Card: Administra√ß√£o (s√≥ para admins) -->
          <div class="dash-card" onclick="navegarParaModulo('admin')" data-module="admin"
            data-permission="system.super_admin">
            <i class="fi fi-rr-settings"></i>
            <h3>Administra√ß√£o</h3>
            <p>Configura√ß√µes do sistema e gerenciamento de usu√°rios</p>
          </div>
        </div>

        <!-- Se√ß√£o de not√≠cias (opcional) -->
        <section class="news-section"
          style="margin-top: 40px; max-width: 1200px; margin-left: auto; margin-right: auto;">
          <h2 style="margin-bottom: 20px; color: var(--color-text);">
            <i class="fi fi-rr-newspaper"></i> Not√≠cias Recentes
          </h2>

          <div style="display: grid; gap: 20px;">
            <article class="card">
              <h3>Nova Pol√≠tica de Atendimento</h3>
              <p>A partir do pr√≥ximo m√™s, haver√° atualiza√ß√µes nos hor√°rios e procedimentos para melhor atender nossos
                clientes.</p>
              <span style="font-size: 12px; color: var(--color-text-light);">Publicado em: 25/01/2025</span>
            </article>

            <article class="card">
              <h3>Campanha de Marketing 2025</h3>
              <p>O novo ciclo de campanhas foca no p√∫blico jovem e em estrat√©gias digitais modernas.</p>
              <span style="font-size: 12px; color: var(--color-text-light);">Publicado em: 20/01/2025</span>
            </article>
          </div>
        </section>
      </div>

      <!-- CONTAINER PARA M√ìDULOS (inicialmente oculto) -->
      <div id="modulos-container" class="modulo-oculto">
        <!-- M√≥dulos ser√£o carregados aqui dinamicamente -->
      </div>
    </main>

    <!-- ===== FOOTER ===== -->
    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2025 Lujo Network - Sistema de Gerenciamento CRM</p>
        <p>
          <small>
            √çcones por <a href="https://www.flaticon.com/" target="_blank">Flaticon</a> |
            <a href="#" id="aboutBtn">Sobre</a> |
            <a href="#" id="helpBtn">Ajuda</a>
          </small>
        </p>
      </div>
    </footer>
  </div>

  <!-- ===== GLOBAL SEARCH (MODAL) ===== -->
  <div class="global-search" id="globalSearch" role="dialog" aria-hidden="true">
    <div class="search-overlay"></div>
    <div class="search-container">
      <div class="search-box">
        <input type="text" id="searchInput" class="search-input"
          placeholder="üîç Buscar m√≥dulo, usu√°rio, ticket... (Pressione ESC para fechar)" autocomplete="off"
          role="searchbox" aria-label="Busca global" />
        <button class="btn-close-search" aria-label="Fechar busca">
          <i class="fi fi-rr-cross"></i>
        </button>
      </div>
      <ul class="search-results" id="searchResults" role="listbox">
        <!-- Resultados preenchidos dinamicamente -->
      </ul>
    </div>
  </div>

  <!-- ===== TOAST NOTIFICATIONS ===== -->
  <div id="toastContainer" class="toast-container" role="region" aria-live="polite" aria-label="Notifica√ß√µes"></div>

  <!-- ===== LOADING GLOBAL ===== -->
  <div id="globalLoading" class="global-loading hidden" role="status" aria-label="Carregando">
    <div class="spinner"></div>
    <p id="loadingText">Carregando...</p>
  </div>

  <!-- ===== MODAL DIALOGS ===== -->
  <!-- SOBRE -->
  <div class="modal" id="modalAbout" role="dialog" aria-labelledby="aboutTitle" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="aboutTitle">Sobre o Sistema</h2>
        <button class="btn-close" aria-label="Fechar">&times;</button>
      </div>
      <div class="modal-body">
        <p><strong>Lujo Network CRM</strong></p>
        <p>Sistema integrado de gerenciamento de relacionamento com cliente.</p>
        <p>
          <strong>Vers√£o:</strong> 2.0.0<br>
          <strong>√öltima atualiza√ß√£o:</strong> Janeiro 2025<br>
          <strong>Desenvolvido com:</strong> Firebase, JavaScript ES6+
        </p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" aria-label="Fechar">Fechar</button>
      </div>
    </div>
  </div>

  <!-- AJUDA -->
  <div class="modal" id="modalHelp" role="dialog" aria-labelledby="helpTitle" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="helpTitle">Central de Ajuda</h2>
        <button class="btn-close" aria-label="Fechar">&times;</button>
      </div>
      <div class="modal-body">
        <h3>Atalhos de Teclado</h3>
        <ul>
          <li><kbd>Ctrl</kbd> + <kbd>/</kbd> - Abrir busca global</li>
          <li><kbd>Ctrl</kbd> + <kbd>L</kbd> - Fazer logout</li>
          <li><kbd>Alt</kbd> + <kbd>1-9</kbd> - Navegar para m√≥dulo</li>
          <li><kbd>ESC</kbd> - Fechar busca/modal</li>
        </ul>

        <h3>M√≥dulos Dispon√≠veis</h3>
        <p id="helpModules">
          <!-- Preenchido dinamicamente -->
        </p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" aria-label="Fechar">Fechar</button>
      </div>
    </div>
  </div>

  <!-- ===== ATRIBUTOS DATA PARA DEBUG ===== -->
  <div style="display: none;" id="debugInfo">
    <!-- Informa√ß√µes de debug (remover em produ√ß√£o) -->
  </div>

</body>

</html>